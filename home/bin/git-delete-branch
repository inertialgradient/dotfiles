#!/usr/bin/env bash

# Delete local and remote branch `name`:
#
# Usage: git delete-branch feature2

branch="$(git branch | cut -c 3- | fzf)"

remote="$(git config branch.$branch.remote)"
test -z "$remote" && remote="origin"

ref="$(git config branch.$branch.merge)"
test -z $ref && ref="refs/heads/$branch"

# delete local branch
git branch -D $branch

# delete local remote-tracking reference
git branch -d -r $remote/$branch

# delete remote branch if --remote passed
if [[ $1 == "--remote" ]]; then
  git push $remote :$ref
fi
