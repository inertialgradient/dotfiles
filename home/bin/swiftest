#!/bin/bash

# Fuzzy-select a swift test example to run
#
# Usage:
#   swiftest

set -e

# fuzzy-select a test
selection="$(xcrun swift test -l |\
             grep --invert-match -E 'Compile|Linking' |\
             sed -E 's/\w+\.\w+\/(\w+)/\1/' |\
             fzf)"

# retrieve the full test name
full_test_name="$(xcrun swift test -l | grep \/$selection'$')"

# run that specific test
xcrun swift test -s $full_test_name
