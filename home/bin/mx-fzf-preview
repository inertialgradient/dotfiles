#!/usr/bin/env bash

set -e

args=($*)
type="${args[0]}"
name="${args[@]:1}"

TMUXINATOR_TEMPLATES_HOME="${TMUXINATOR_TEMPLATES_HOME:-$HOME/.config/tmuxinator}"

if [[ "$type" == '[session]' ]]; then
    tmux list-windows \
         -t "$name" \
         -F '#{window_index}: #{window_name} (#{window_panes} panes)'
    echo --------------- [Preview] ---------------
    tmux capture-pane -pt "$name"
fi

if [[ "$type" == '[template]' ]]; then
    bat --color=always \
        "${TMUXINATOR_TEMPLATES_HOME}"/"${name}".{yml,yaml} 2>/dev/null
fi
