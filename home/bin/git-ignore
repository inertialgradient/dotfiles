#!/usr/bin/env bash

set -e

langs_list="1c-bitrix,a-frame,actionscript,ada,adobe
advancedinstaller,agda,alteraquartusii,altium,android
androidstudio,angular,anjuta,ansible,apachecordova
appbuilder,appceleratortitanium,appcode,appengine,aptanastudio
arcanist,archive,archives,archlinuxpackages,assembler
atmelstudio,ats,audio,automationstudio,autotools
backup,basercms,basic,batch,bazaar
bazel,bitrix,bittorrent,blackbox,bluej
bower,bricxcc,buck,c,c++
cake,cakephp,calabash,carthage,ceylon
cfwheels,chefcookbook,clean,clion,clojure
cloud9,cmake,cocos2dx,code,code-java
codeblocks,codecomposerstudio,codeigniter,codeio,codekit
coffeescript,commonlisp,composer,compressed,compressedarchive
compression,concrete5,coq,craftcms,crashlytics
crossbar,crystal,csharp,cuda,cvs
d,dart,darteditor,data,database
datarecovery,delphi,diskimage,django,dm
dotfilessh,dotsettings,dreamweaver,dropbox,drupal7
drupal8,eagle,easybook,eclipse,eiffelstudio
elasticbeanstalk,elisp,elixir,elm,emacs
ember,ensime,episerver,erlang,espresso
executable,expressionengine,extjs,f#,fancy
fastlane,finale,flashbuilder,flex,flexbuilder
font,fontforge,forcedotcom,fortran,freepascal
fuelphp,fusetools,games,gcov,genero4gl
ggts,gis,git,gitbook,go
gpg,gradle,grails,greenfoot,grunt
gwt,haskell,hexo,hsp,hugo
iar,iar_ewarm,idris,igorpro,images
infer,intellij,intellij+iml,jabref,java
java-web,jboss,jboss-4-2-3-ga,jboss-6-x,jdeveloper
jekyll,jetbrains,jmeter,joe,joomla
jspm,julia,justcode,kate,kdevelop4
kentico,kicad,kirby2,kobalt,kohana
komodoedit,labview,laravel,latex,lazarus
leiningen,lemonstand,less,liberosoc,librarian-chef
libreoffice,lilypond,linux,lithium,lua
lyx,m2e,macos,magento,magento2
matlab,maven,mavensmate,mercurial,mercury
metaprogrammingsystem,meteorjs,microsoftoffice,mikroc,modelsim
modx,momentics,monodevelop,nanoc,ncrunch
nesc,netbeans,nette,nikola,nim
ninja,node,notepadpp,nwjs,objective-c
ocaml,octobercms,opa,opencart,opencv
openfoam,openframeworks,oracleforms,osx,otto
packer,particle,pawn,perl,perl6
ph7cms,phalcon,phoenix,phpstorm,pimcore
pinegrow,playframework,plone,polymer,premake-gmake
prestashop,processing,progressabl,psoccreator,puppet-librarian
purebasic,purescript,pycharm,pydev,python
qml,qooxdoo,qt,qtcreator,r
racket,rails,redcar,redis,rhodesrhomobile
root,ros,ruby,rubymine,rust
salesforce,sas,sass,sbt,scala
scheme,scons,scrivener,sdcc,seamgen
senchatouch,serverless,shopware,silverstripe,sketchup
slickedit,smalltalk,snapcraft,sonar,sourcepawn
splunk,spreadsheet,stata,stdlib,stella
stellar,stylus,sublimetext,sugarcrm,svn
swift,swiftpackagemanager,swiftpm,symfony,symphonycms
synology,synopsysvcs,tags,tarmainstallmate,terraform
test,testcomplete,tex,text,textmate
textpattern,theos-tweak,tortoisegit,tower,turbogears2
typings,typo3,umbraco,unity,unrealengine
vagrant,valgrind,vapor,video,vim
virtualenv,virtuoso,visualstudio,visualstudiocode,vivado
vvvv,waf,wakanda,web,webmethods
webstorm,werckercli,windows,wintersmith,wordpress
xamarinstudio,xcode,xilinxise,xojo,xtext
y86,yeoman,yii,yii2,zendframework
zephir"

if [ "$1" == "-r" ]; then
  langs_list="$(curl -L -s "https://www.gitignore.io/api/list")"
fi

langs_selection="$(echo "$langs_list" |\
  sed -e 's/,/\n/g' |\
  fzf-tmux -i -d 15 --ansi --no-sort --reverse --tiebreak=index)"

query_param="${langs_selection//$'\n'/,}"

echo "Writing to a .gitignore file for project types:"
echo "$langs_selection"

curl -L -s "https://www.gitignore.io/api/$query_param" \
  >> .gitignore

echo "done."


